% !TeX encoding = ISO-8859-2

\chapter{Eredmények}
\section{Bordacímkézés}
Az eredményeket az alábbi \ref{tab:eredmeny_tab}-es táblázat foglalja össze.
Az algoritmus kiértékelése, illetve a paramétereinek behangolása 60 képen történt.
Ezen 60 képen összesen 1423 borda látható a jobb és baloldali bordát külön számolva.

A táblázat második oszlopában a kiszegmentált bordák száma látható.
Szegmentált borda alatt azokat értjük, melyek a már címkézett képen szegmentáltan szerepelnek, nem feltétlenül helyes címkével.
A táblázat harmadik oszlopa szigorúbb feltételt állít fel, itt a szegmentáltság mellett a borda címkéjének is megfelelõnek kell lennie.
Egyes esetekben elõfordulhat, hogy a bordák jó sorrendben kerülnek felcímkézésre, de zaj, vagy csigolyanyúlvány bekerülése miatt elcsúszik a címkézés.
A táblázat utolsó oszlopa a fix pont segítségével címkézett bordák arányát számszerûsíti.

% Please add the following required packages to your document preamble:
% \usepackage{booktabs}
\begin{table}[h]
	\begin{tabular}{@{}|c|c|c|c|@{}}
		\toprule
		\textbf{Bordák} & \textbf{Kiszegmentált bordák} & \textbf{Helyesen címkézett bordák} & \textbf{Fix pont megadásával}  \\ \midrule
		1423            & 1301                          & 998                                & 1161                           \\ \midrule
		100\%           & 91.4\%                        & 79.5\%                             & 81.5\%                         \\ \bottomrule
	\end{tabular}
	\caption{Eredmények összefoglalása bordák címkézésére} \label{tab:eredmeny_tab}
\centering
\end{table}
\section{Csigolyák szétválasztása bordák alapján}
A csigolyák szétválasztása ugyanazon a 60 képen került kiértékelésre mint a bordacímkézés.
A képekre egyenként megvizsgáltuk, hogy az algoritmus által becsült szétválasztás adott csigolyára milyen távol van az eredeti helyétõl.
Ezt a távolságot az axiális szeletek számában tudjuk kifejezni.
\Aref{tab:eredmeny_tab_ver} táblázatban láthatóak a csigolyánkénti átlag hibák szeletszámban kifejezve.
A táblázat felsõ sora annak a csigolyának a címkéjét reprezentálja melyet el szeretnénk választani fölötte lévõ csigolyától.
A címke pedig a csigolyához tartozó borda alapján kerül meghatározásra.
Az 1-es számú címke az elsõ bordát, és ahhoz tartozó csigolyát jelenti, és így sorba a többi.

\Aref{fig:ver_hiba} ábrán szemlélteti a hiba változását, melyen jól látszik, hogy a 11. illetve a 12. bordákhoz tartozó csigolyák a legproblémásabbak.
Ez nem véletlen, hiszen a két utolsó borda a lengõborda eltér a többi bordától.
Az is látszik, hogy a gerinc közepénél érte el az algoritmus a legpontosabb eredményt, hiszen itt van a legkevésbé íves része a gerincnek.

\begin{table}[]
	\begin{tabular}{|c|c|c|l|l|l|l|l|l|l|l|l|l|}
		\hline
		\textbf{Címke} & 1    & 2   & 3    & 4    & 5    & 6    & 7    & 8    & 9    & 10  & 11   & 12   \\ \hline
		\textbf{Hiba}  & 5,05 & 6,1 & 5,14 & 5,02 & 4,46 & 2,95 & 2,58 & 2,73 & 3,27 & 3,8 & 6,65 & 9,09 \\ \hline
	\end{tabular}
	\caption{Eredmények összefoglalása csigolyák szétválasztására} \label{tab:eredmeny_tab_ver}
\centering
\end{table}

\begin{figure}[h]
	\includegraphics[width=\textwidth]{ver_hiba}
	\caption{Hiba szemléltetése grafikonon} \label{fig:ver_hiba}
	\centering
\end{figure}

\section{Csigolyák szétválasztása 2D összegkép alapján}

A csigolyák szétválasztása ugyanazon a 60 képen került kiértékelésre mint az elõzõ mód-
szerek. A képekre egyenként megvizsgáltuk, hogy az algoritmus által behúzott vonalak
alapján a képen látható csigolyák hány százaléka választható el.
A teszt képeken átlagos esetben 16 csigolya volt látható, ebbõl esetenként átlagosan
13 választható el megfelelõen és átlagosan 3 nem. Így a képeken szereplõ összes gerinc
csigolyáinak 82\%-a választható szét jól a módszerrel. Ezekben az esetekben egyik csigo-
lya cimkéjét manuálisan megadva a többi csigolya cimkéje is meghatározható.
Legnehezebb régiónak a nyaki csigolyák bizonyultak, amelynek több oka is van:
\begin{itemize}
\item a csigolyák mérete kisebb, így a határok kevésbé jól láthatóak (szeletvastagság)
\item a nyaki csigolyák tipikusan nagyobb ívet írnak le, mint a többi csigolya, így víz-
szintes vonalak behúzásával csak közelíteni lehet a valódi csigolyahatárokat
\end{itemize}

A többi régióról viszont elmondható, hogy átlagos esetben sikeresen szétválasztja az
összes csigolyát. Így ez a módszer pontosabb eredményt szolgáltat az elõzõ, borda alapú
kijelölésnél, hiszen:
\begin{itemize}
\item nem csak a borda régió csigolyáit választja szét
\item pontosabb a szétválasztás
\end{itemize}



\section{Különbözõ esetek részeredményeinek szemléltetése bordákra}

E fejezetben különbözõ esetekre láthatunk példákat a bordák címkézésének folyamatára.

Az esetenkénti elsõ képeken a csont szegmentálásának az eredményét láthatjuk.
Itt még minden csontszerkezet látszik.
A második képeken látható a gerinc kijelölésének végleges eredménye.
A gerinc kijelölése három lépésbõl áll, itt most csak az utolsó lépés eredményét szemléltetem, azzal, hogy visszavetítem az eredeti CT képre így látszik csak a gerinc.
Végül az utolsó képeken látható a bordák detektálásának az eredménye.
Szürke árnyalatokkal látható a csont illetve a segédvonalak melyek mentén zajlik a bordák keresése és színesen pedig már az szegmentált, illetve felcímkézett bordák.
A segédvonalakat a detektált körök alapján helyezem el, ez ki is rajzolódik az utolsó képek jobboldali képén.
A különbözõ színû bordák különbözõ címkéket reprezentálnak.



\newcommand{\scale}{0.7}
%\section*{1. eset}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{csont_1_7}
	\centering
	\caption{Csont szegmentálás} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{gerinc_2_7}
	\centering
	\caption{Gerinc kijelölés} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{szeg_3_7}
	\centering
	\caption{Régiónövelés} \label{fig:korrig_1_1}
\end{figure}
%\section*{2. eset}
%\begin{comment}
%-----------------------------------------
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{csont_1_11}
	\centering
	\caption{Csont szegmentálás} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{gerinc_2_11}
	\centering
	\caption{Gerinc kijelölés} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{szeg_3_11}
	\centering
	\caption{Régiónövelés} \label{fig:korrig_1_1}
\end{figure}
%-----------------------------------------
%\section*{3. eset}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{csont_1_15}
	\centering
	\caption{Csont szegmentálás} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{gerinc_2_15}
	\centering
	\caption{Gerinc kijelölés} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{szeg_3_15}
	\centering
	\caption{Régiónövelés} \label{fig:korrig_1_1}
\end{figure}
%-----------------------------------------
%\section*{4. eset}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{csont_1_22}
	\centering
	\caption{Csont szegmentálás} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{gerinc_2_22}
	\centering
	\caption{Gerinc kijelölés} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{szeg_3_22}
	\centering
	\caption{Régiónövelés} \label{fig:korrig_1_1}
\end{figure}
%-----------------------------------------
%\section*{5. eset}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{csont_1_26}
	\centering
	\caption{Csont szegmentálás} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{gerinc_2_26}
	\centering
	\caption{Gerinc kijelölés} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{szeg_3_26}
	\centering
	\caption{Régiónövelés} \label{fig:korrig_1_1}
\end{figure}
%-----------------------------------------
%\section*{6. eset}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{csont_1_29}
	\centering
	\caption{Csont szegmentálás} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{gerinc_2_29}
	\centering
	\caption{Gerinc kijelölés} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{szeg_3_29}
	\centering
	\caption{Régiónövelés} \label{fig:korrig_1_1}
\end{figure}
%-----------------------------------------
%\section*{7. eset}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{csont_1_30}
	\centering
	\caption{Csont szegmentálás} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{gerinc_2_30}
	\centering
	\caption{Gerinc kijelölés} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{szeg_3_30}
	\centering
	\caption{Régiónövelés} \label{fig:korrig_1_1}
\end{figure}
%-----------------------------------------
%\section*{8. eset}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{csont_1_39}
	\centering
	\caption{Csont szegmentálás} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{gerinc_2_39}
	\centering
	\caption{Gerinc kijelölés} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{szeg_3_39}
	\centering
	\caption{Régiónövelés} \label{fig:korrig_1_1}
\end{figure}
%-----------------------------------------
%\section*{9. eset}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{csont_1_42}
	\centering
	\caption{Csont szegmentálás} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{gerinc_2_42}
	\centering
	\caption{Gerinc kijelölés} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{szeg_3_42}
	\centering
	\caption{Régiónövelés} \label{fig:korrig_1_1}
\end{figure}
%-----------------------------------------
%\section*{10. eset}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{csont_1_46}
	\centering
	\caption{Csont szegmentálás} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{gerinc_2_46}
	\centering
	\caption{Gerinc kijelölés} \label{fig:korrig_1_1}
\end{figure}
\begin{figure}[h]
	\includegraphics[width=\scale\textwidth]{szeg_3_46}
	\centering
	\caption{Régiónövelés} \label{fig:korrig_1_1}
\end{figure}
%-----------------------------------------


\section{Különbözõ esetek részeredményeinek szemléltetése csigolyákra}
A zárójelben felsorolt képeken (\ref{fig:hatar_09}, \ref{fig:hatar_12}, \ref{fig:hatar_13}, \ref{fig:hatar_14}, \ref{fig:hatar_39}, \ref{fig:hatar_46}) a csigolya közötti rések becslését láthatjuk a két módszer alapján.
A borda alapú algoritmus eredménye a piros vonal mélység koordinátája.
A zöld nyíl azt mutatja meg, hogy hol kellene elhelyezkednie a csigolyák határának. 
Ahol nincs drasztikus eltérés az algoritmus eredménye és a tényleges határ között, oda nem került berajzolásra.
Láthatjuk, hogy az alsó csigolyákhoz kapcsolódó lengõbordákkal történõ becslés instabil eredményt szolgáltat, míg a gerinc közepén lévõ csigolya közti rések helyesen szerepelnek több esetben is.

A 2D összegkép alapú csigolyaszétválasztás eredményeit szintén egy-egy vonal szemlélteti (fekete).

\begin{figure}[htb]%
\centering
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/hatar_09}}%
  \centerline{Csigolyák (borda alapján)}\medskip%
\end{minipage}%
%\hspace{1cm}
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/9}}%
  \centerline{Csigolyák (2D összegkép alapján)}\medskip%
\end{minipage}%
\caption{9. eset}
\label{fig:hatar_09}

\end{figure}

\begin{figure}[htb]%
\centering
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/hatar_12}}%
  \centerline{Csigolyák (borda alapján)}\medskip%
\end{minipage}%
%\hspace{1cm}
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/12}}%
  \centerline{Csigolyák (2D összegkép alapján)}\medskip%
\end{minipage}%
\caption{12. eset}
\label{fig:hatar_12}

\end{figure}

\begin{figure}[htb]%
\centering
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/hatar_13}}%
  \centerline{Csigolyák (borda alapján)}\medskip%
\end{minipage}%
%\hspace{1cm}
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/13}}%
  \centerline{Csigolyák (2D összegkép alapján)}\medskip%
\end{minipage}%
\caption{13. eset}
\label{fig:hatar_13}

\end{figure}

\begin{figure}[htb]%
\centering
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/hatar_14}}%
  \centerline{Csigolyák (borda alapján)}\medskip%
\end{minipage}%
%\hspace{1cm}
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/14}}%
  \centerline{Csigolyák (2D összegkép alapján)}\medskip%
\end{minipage}%
\caption{14. eset}
\label{fig:hatar_14}

\end{figure}

\begin{figure}[htb]%
\centering
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/hatar_39}}%
  \centerline{Csigolyák (borda alapján)}\medskip%
\end{minipage}%
%\hspace{1cm}
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/39}}%
  \centerline{Csigolyák (2D összegkép alapján)}\medskip%
\end{minipage}%
\caption{39. eset}
\label{fig:hatar_39}

\end{figure}

\begin{figure}[htb]%
\centering
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/hatar_46}}%
  \centerline{Csigolyák (borda alapján)}\medskip%
\end{minipage}%
%\hspace{1cm}
\begin{minipage}[b]{0.4\textwidth}%
  \centering%
  \centerline{\includegraphics[height=10cm]{images/46}}%
  \centerline{Csigolyák (2D összegkép alapján)}\medskip%
\end{minipage}%
\caption{46. eset}
\label{fig:hatar_46}

\end{figure}


%\end{comment}
\begin{comment}
\section{Csont szegmentálása}

\section{Gerinc kijelölése}

\section{Borda detektálás}

\section{Borda alakú objektumok}

\section{Címkézett bordák}
\end{comment}